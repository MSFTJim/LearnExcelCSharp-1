using System.ComponentModel.Design.Serialization;
using System.Data.Common;
using xCel = Microsoft.Office.Interop.Excel;

namespace ConsoleExcel2
{
    internal class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("Start!");
            string OneAskFile = "C:\\Users\\jamesvac\\Documents\\OneAskData3.xlsx";
            xCel.Application myExcel = new Microsoft.Office.Interop.Excel.Application();
            xCel.Workbook myWorkbook;
            xCel.Worksheet myWorkssheet;

            myWorkbook = myExcel.Workbooks.Open(OneAskFile);
            myWorkssheet = myWorkbook.Worksheets[1];
            int lastRow = myWorkssheet.Cells.SpecialCells(xCel.XlCellType.xlCellTypeLastCell).Row;

            //xCel.Range myRange = myWorkssheet.Range["d2:d"+lastRow];            
            //myRange.set_Value(xCel.XlRangeValueDataType.xlRangeValueDefault,"blue");

            //int row = 2;
            int col = 4;



            //myWorkssheet.Cells[6, col] = OneAskClassification(myWorkssheet.Cells[row + 4, col + 1].ToString());

            //myWorkssheet.Cells[lastRow, Column];
            //myWorkssheet.Cells[row, col] = myWorkssheet.Cells[row, col + 1];
            //myWorkssheet.Cells[row+2, col] = "Viking";

            //for (int row = 2; row <= lastRow; row++)
            //{
            //    myWorkssheet.Cells[row, col] = myWorkssheet.Cells[row, col + 1];
            //}

            string Toby = myWorkssheet.Cells[6, col + 1].Value2;

            myWorkssheet.Cells[6, col + 1].Value();


            myWorkssheet.Cells[6, col] = OneAskClassification(myWorkssheet.Cells[6, col + 1].ToString());

            //myWorkssheet.Cells[row+4, col] = OneAskClassification(myWorkssheet.Cells[row+4, col + 1].ToString());


            myWorkbook.Save();
            myWorkbook.Close();

            Console.WriteLine("End!");


        } // end main
        private static string? OneAskClassification(string? Title)
        {
            string oneaskClass = "not set";

            if (Title.Contains("AKS"))
                oneaskClass = "AKS";
            else
                oneaskClass = "Not AKS";


            return oneaskClass;

        } // end OneAskClassification

        } // end class
    } // end namespace